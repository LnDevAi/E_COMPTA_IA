"use strict";(self.webpackChunke_compta_ia=self.webpackChunke_compta_ia||[]).push([[641],{9641:(V,T,d)=>{d.r(T),d.d(T,{AiAssistantComponent:()=>y});var j=d(467),b=d(177),C=d(4341),t=d(4438),F=d(2374),R=d(1941);function I(l,A){if(1&l&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"number"),t.k0s()),2&l){const s=t.XpG();t.R7$(),t.SpI("OCR en cours... ",t.i5U(2,1,100*s.progress,"1.0-0"),"%")}}function k(l,A){if(1&l){const s=t.RV6();t.j41(0,"tr")(1,"td")(2,"input",3),t.mxI("ngModelChange",function(e){const i=t.eBV(s).$implicit;return t.DH7(i.label,e)||(i.label=e),t.Njj(e)}),t.k0s()(),t.j41(3,"td")(4,"input",29),t.mxI("ngModelChange",function(e){const i=t.eBV(s).index,n=t.XpG();return t.DH7(n.meta.items[i].amount,e)||(n.meta.items[i].amount=e),t.Njj(e)}),t.k0s()(),t.j41(5,"td")(6,"button",35),t.bIt("click",function(){const e=t.eBV(s).index,i=t.XpG();return t.Njj(i.meta.items.splice(e,1))}),t.EFF(7,"\u2716"),t.k0s()()()}if(2&l){const s=A.$implicit,a=A.index,e=t.XpG();t.R7$(2),t.R50("ngModel",s.label),t.R7$(2),t.R50("ngModel",e.meta.items[a].amount)}}function D(l,A){if(1&l){const s=t.RV6();t.j41(0,"tr")(1,"td")(2,"input",46),t.mxI("ngModelChange",function(e){const i=t.eBV(s).$implicit;return t.DH7(i.compte,e)||(i.compte=e),t.Njj(e)}),t.k0s()(),t.j41(3,"td")(4,"input",3),t.mxI("ngModelChange",function(e){const i=t.eBV(s).$implicit;return t.DH7(i.libelle,e)||(i.libelle=e),t.Njj(e)}),t.k0s()(),t.j41(5,"td")(6,"input",47),t.mxI("ngModelChange",function(e){const i=t.eBV(s).$implicit;return t.DH7(i.debit,e)||(i.debit=e),t.Njj(e)}),t.bIt("input",function(){t.eBV(s);const e=t.XpG(2);return t.Njj(e.recalc())}),t.k0s()(),t.j41(7,"td")(8,"input",47),t.mxI("ngModelChange",function(e){const i=t.eBV(s).$implicit;return t.DH7(i.credit,e)||(i.credit=e),t.Njj(e)}),t.bIt("input",function(){t.eBV(s);const e=t.XpG(2);return t.Njj(e.recalc())}),t.k0s()(),t.j41(9,"td")(10,"button",35),t.bIt("click",function(){const e=t.eBV(s).index,i=t.XpG(2);return i.proposal.splice(e,1),t.Njj(i.recalc())}),t.EFF(11,"\u2716"),t.k0s()()()}if(2&l){const s=A.$implicit;t.R7$(2),t.R50("ngModel",s.compte),t.R7$(2),t.R50("ngModel",s.libelle),t.R7$(2),t.R50("ngModel",s.debit),t.R7$(2),t.R50("ngModel",s.credit)}}function N(l,A){if(1&l){const s=t.RV6();t.j41(0,"div")(1,"h3"),t.EFF(2,"Proposition d'\xe9critures"),t.k0s(),t.j41(3,"div",1)(4,"label"),t.EFF(5,"Journal "),t.j41(6,"select",3),t.mxI("ngModelChange",function(e){t.eBV(s);const i=t.XpG();return t.DH7(i.journalCode,e)||(i.journalCode=e),t.Njj(e)}),t.j41(7,"option",36),t.EFF(8,"ACH - Achats"),t.k0s(),t.j41(9,"option",37),t.EFF(10,"VEN - Ventes"),t.k0s(),t.j41(11,"option",38),t.EFF(12,"BNK - Banque"),t.k0s(),t.j41(13,"option",39),t.EFF(14,"OD - Op\xe9rations diverses"),t.k0s(),t.j41(15,"option",40),t.EFF(16,"SAL - Salaires"),t.k0s(),t.j41(17,"option",41),t.EFF(18,"CSH - Caisses"),t.k0s(),t.j41(19,"option",42),t.EFF(20,"MNE - Monnaie \xe9lectronique"),t.k0s()()(),t.j41(21,"input",27),t.mxI("ngModelChange",function(e){t.eBV(s);const i=t.XpG();return t.DH7(i.date,e)||(i.date=e),t.Njj(e)}),t.k0s(),t.j41(22,"input",43),t.mxI("ngModelChange",function(e){t.eBV(s);const i=t.XpG();return t.DH7(i.piece,e)||(i.piece=e),t.Njj(e)}),t.k0s(),t.j41(23,"input",44),t.mxI("ngModelChange",function(e){t.eBV(s);const i=t.XpG();return t.DH7(i.reference,e)||(i.reference=e),t.Njj(e)}),t.k0s()(),t.j41(24,"table",30)(25,"thead")(26,"tr")(27,"th"),t.EFF(28,"Compte"),t.k0s(),t.j41(29,"th"),t.EFF(30,"Libell\xe9"),t.k0s(),t.j41(31,"th"),t.EFF(32,"D\xe9bit"),t.k0s(),t.j41(33,"th"),t.EFF(34,"Cr\xe9dit"),t.k0s(),t.nrm(35,"th"),t.k0s()(),t.j41(36,"tbody"),t.DNE(37,D,12,4,"tr",31),t.k0s(),t.j41(38,"tfoot")(39,"tr")(40,"th",45),t.EFF(41,"Totaux"),t.k0s(),t.j41(42,"th"),t.EFF(43),t.nI1(44,"number"),t.k0s(),t.j41(45,"th"),t.EFF(46),t.nI1(47,"number"),t.k0s(),t.nrm(48,"th"),t.k0s(),t.j41(49,"tr")(50,"th",45),t.EFF(51,"Balance (doit \xeatre 0)"),t.k0s(),t.j41(52,"th",45),t.EFF(53),t.nI1(54,"number"),t.k0s(),t.nrm(55,"th"),t.k0s()()(),t.j41(56,"div",1)(57,"button",32),t.bIt("click",function(){t.eBV(s);const e=t.XpG();return t.Njj(e.addLine())}),t.EFF(58,"Ajouter ligne"),t.k0s(),t.j41(59,"button",7),t.bIt("click",function(){t.eBV(s);const e=t.XpG();return t.Njj(e.save())}),t.EFF(60,"Enregistrer dans \xc9critures"),t.k0s()()()}if(2&l){const s=t.XpG();t.R7$(6),t.R50("ngModel",s.journalCode),t.R7$(15),t.R50("ngModel",s.date),t.R7$(),t.R50("ngModel",s.piece),t.R7$(),t.R50("ngModel",s.reference),t.R7$(14),t.Y8G("ngForOf",s.proposal),t.R7$(6),t.JRh(t.i5U(44,9,s.totalDebit,"1.2-2")),t.R7$(3),t.JRh(t.i5U(47,12,s.totalCredit,"1.2-2")),t.R7$(7),t.JRh(t.i5U(54,15,s.totalDebit-s.totalCredit,"1.2-2")),t.R7$(6),t.Y8G("disabled",!s.proposal.length)}}function P(l,A){if(1&l&&(t.j41(0,"div",48),t.EFF(1),t.k0s()),2&l){const s=t.XpG();t.R7$(),t.JRh(s.error)}}function S(l,A){if(1&l&&(t.j41(0,"div",49),t.EFF(1),t.k0s()),2&l){const s=t.XpG();t.R7$(),t.JRh(s.ok)}}let y=(()=>{class l{constructor(s,a){this.coa=s,this.js=a,this.files=[],this.language="fra",this.ocrRunning=!1,this.progress=0,this.extracted="",this.hint="",this.journalCode="OD",this.date=(new Date).toISOString().slice(0,10),this.piece="",this.reference="",this.proposal=[],this.totalDebit=0,this.totalCredit=0,this.error="",this.ok="",this.operationType="DETECT",this.tvaRate=18,this.acctTvaCollecte="445",this.acctTvaDeductible="345",this.acctVentePrestations="706",this.acctVenteMarchandises="701",this.acctAchatPrestations="611",this.acctAchatMarchandises="601",this.yourCompany="",this.meta={items:[],totals:{}},this.loadSettings()}loadSettings(){try{const s=localStorage.getItem("assistant_settings_v1");s&&Object.assign(this,JSON.parse(s))}catch{}}saveSettings(){try{localStorage.setItem("assistant_settings_v1",JSON.stringify({yourCompany:this.yourCompany,operationType:this.operationType,tvaRate:this.tvaRate,acctTvaCollecte:this.acctTvaCollecte,acctTvaDeductible:this.acctTvaDeductible,acctVentePrestations:this.acctVentePrestations,acctVenteMarchandises:this.acctVenteMarchandises,acctAchatPrestations:this.acctAchatPrestations,acctAchatMarchandises:this.acctAchatMarchandises}))}catch{}}onFiles(s){const a=s.target;this.files=a.files?Array.from(a.files):[]}runOcr(){var s=this;return(0,j.A)(function*(){if(s.error=s.ok="",s.files.length){s.ocrRunning=!0,s.progress=0;try{const a=yield Promise.all([d.e(76),d.e(74)]).then(d.t.bind(d,1074,23)),e=yield Promise.all([d.e(76),d.e(717)]).then(d.t.bind(d,717,23));e.GlobalWorkerOptions.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js";let i="";for(const n of s.files){const o=(n.name||"").toLowerCase();if(o.endsWith(".pdf")){const r=yield n.arrayBuffer(),u=yield e.getDocument({data:r}).promise;for(let g=1;g<=u.numPages;g++)i+=(yield(yield u.getPage(g)).getTextContent()).items.map(p=>p.str).join(" ")+"\n"}else if(o.endsWith(".txt")||o.endsWith(".csv")||o.endsWith(".json"))i+=(yield n.text())+"\n";else{const{data:r}=yield a.recognize(n,s.language,{logger:u=>{"recognizing text"===u.status&&null!=u.progress&&(s.progress=u.progress)}});i+=(r.text||"")+"\n"}}s.extracted=i.trim(),s.analyzeText()}catch(a){s.error="OCR: "+(a?.message||a)}finally{s.ocrRunning=!1}}})()}analyzeText(){const s=(this.extracted||"").replace(/\u00A0/g," ").trim(),a=s.toLowerCase(),e={items:[],totals:{}};e.docType=/facture/.test(a)?"FACTURE":/recu|re\xe7u/.test(a)?"RECU":/devis/.test(a)?"DEVIS":/bulletin/.test(a)?"BULLETIN":/releve|relev\xe9/.test(a)?"RELEVE":"AUTO";const i=s.match(/\b(N\xb0|No|Num(\xe9|e)ro)\s*[:#\-]?\s*([A-Za-z0-9\-\/]{3,})/i);i&&(e.invoiceNumber=i[3]);const n=s.match(/\b(20\d{2})[-\/.](\d{1,2})[-\/.](\d{1,2})\b/),o=s.match(/\b(\d{1,2})[\/.](\d{1,2})[\/.](20\d{2})\b/);n?e.date=`${n[1]}-${n[2].padStart(2,"0")}-${n[3].padStart(2,"0")}`:o&&(e.date=`${o[3]}-${o[2].padStart(2,"0")}-${o[1].padStart(2,"0")}`),/XOF|FCFA|CFA/i.test(s)?e.currency="XOF":/EUR|\u20ac/.test(s)?e.currency="EUR":/USD|\$/.test(s)&&(e.currency="USD");const r=s.match(/(Fournisseur|\xc9metteur|Emetteur|Vendeur|Prestataire)\s*[:\-]?\s*(.+)/i),u=s.match(/(Client|Destinataire|Acheteur|B\xe9n\xe9ficiaire)\s*[:\-]?\s*(.+)/i);r&&(e.issuer=r[2].split("\n")[0].trim()),u&&(e.recipient=u[2].split("\n")[0].trim()),e.issuer||(e.issuer=(s.split("\n")[0]||"").trim());const g=s.match(/(Objet|Description|Prestation)\s*[:\-]?\s*(.+)/i);g&&(e.subject=g[2].split("\n")[0].trim());const f=h=>Number(h.replace(/\s/g,"").replace(/\./g,"").replace(/,/g,".")),c=s.match(/(Total\s*TTC|TTC)\s*[:\-]?\s*([0-9\s.,]+)/i),m=s.match(/(Total\s*HT|Montant\s*HT)\s*[:\-]?\s*([0-9\s.,]+)/i),p=s.match(/(TVA|Taxe)\s*[:\-]?\s*([0-9\s.,]+)/i);c&&(e.totals.ttc=f(c[2])),m&&(e.totals.ht=f(m[2])),p&&(e.totals.tva=f(p[2]));const _=s.split(/\n+/).map(h=>h.trim()).filter(Boolean);for(const h of _){const M=h.match(/(.{6,}?)\s+([0-9][0-9\s.,]{2,})$/);if(M){const O=M[1].trim(),E=f(M[2]);!isNaN(E)&&E>0&&e.items.push({label:O,amount:E})}}!e.items.length&&e.subject&&e.totals.ht&&e.items.push({label:e.subject,amount:e.totals.ht}),this.meta=e}proposeEntries(){this.error=this.ok="";const s=(this.extracted+"\n"+this.hint).toLowerCase(),a=[],e=/(\d+[\s.,]?\d{0,3}(?:[\s.,]\d{3})*(?:[\s.,]\d{2})?)/g,i=[];for(const p of s.match(e)||[]){const _=Number(String(p).replace(/\s/g,"").replace(/\./g,"").replace(/,/g,"."));!isNaN(_)&&isFinite(_)&&i.push(Math.abs(_))}let n=this.meta.totals.ht||0,o=this.meta.totals.tva||0;!n&&this.meta.items.length&&(n=this.meta.items.reduce((p,_)=>p+(_.amount||0),0)),!n&&i.length&&(n=i.sort((p,_)=>_-p)[0]||0),!o&&/(tva|taxe)/.test(s)&&(o=Math.round(n*(this.tvaRate/100)*100)/100);const u=/prestation|service|honoraire/.test(s)||(this.meta.subject||"").toLowerCase().match(/prestation|service|honoraire/),g=/facture\s*(client|vente)|client|ventes?/.test(s),f=/facture\s*(fournisseur|achat)|fournisseur|achats?/.test(s);let c=this.operationType;if("DETECT"===c){if(this.yourCompany){const p=(this.meta.issuer||"").toLowerCase(),_=(this.meta.recipient||"").toLowerCase(),h=this.yourCompany.toLowerCase();_.includes(h)&&!p.includes(h)?c=u?"ACHAT_PRESTATIONS":"ACHAT_MARCHANDISES":p.includes(h)&&!_.includes(h)&&(c=u?"VENTE_PRESTATIONS":"VENTE_MARCHANDISES")}"DETECT"===c&&(g?c=u?"VENTE_PRESTATIONS":"VENTE_MARCHANDISES":f&&(c=u?"ACHAT_PRESTATIONS":"ACHAT_MARCHANDISES")),"DETECT"===c&&(c="VENTE_PRESTATIONS")}c.startsWith("VENTE")?this.journalCode="VEN":c.startsWith("ACHAT")?this.journalCode="ACH":c.startsWith("BANQUE")?this.journalCode="BNK":"PAIE_SALAIRE"===c&&(this.journalCode="SAL");const m=this.meta.subject||this.meta.items[0]?.label||this.meta.docType||"Pi\xe8ce";if("VENTE_PRESTATIONS"===c&&n)a.push({compte:"411",libelle:"Clients",debit:n+o,credit:0}),o&&a.push({compte:this.acctTvaCollecte,libelle:"TVA collect\xe9e",debit:0,credit:o}),a.push({compte:this.acctVentePrestations,libelle:m,debit:0,credit:n});else if("VENTE_MARCHANDISES"===c&&n)a.push({compte:"411",libelle:"Clients",debit:n+o,credit:0}),o&&a.push({compte:this.acctTvaCollecte,libelle:"TVA collect\xe9e",debit:0,credit:o}),a.push({compte:this.acctVenteMarchandises,libelle:m,debit:0,credit:n});else if("ACHAT_PRESTATIONS"===c&&n)a.push({compte:this.acctAchatPrestations,libelle:m,debit:n,credit:0}),o&&a.push({compte:this.acctTvaDeductible,libelle:"TVA d\xe9ductible",debit:o,credit:0}),a.push({compte:"401",libelle:"Fournisseurs",debit:0,credit:n+o});else if("ACHAT_MARCHANDISES"===c&&n)a.push({compte:this.acctAchatMarchandises,libelle:m,debit:n,credit:0}),o&&a.push({compte:this.acctTvaDeductible,libelle:"TVA d\xe9ductible",debit:o,credit:0}),a.push({compte:"401",libelle:"Fournisseurs",debit:0,credit:n+o});else if("PAIE_SALAIRE"===c&&n){const p=/cnps|cnss|cotis/.test(s)?Math.round(.25*n*100)/100:0,_=Math.max(0,n-p);a.push({compte:"641",libelle:"R\xe9mun\xe9rations du personnel",debit:n,credit:0}),p&&a.push({compte:"43",libelle:"Organismes sociaux",debit:0,credit:p}),a.push({compte:"421",libelle:"Personnel - R\xe9mun\xe9rations dues",debit:0,credit:_})}!a.length&&n&&(a.push({compte:"",libelle:m,debit:n,credit:0}),a.push({compte:"",libelle:m,debit:0,credit:n})),this.proposal=a,this.recalc()}findAccount(s){let a=null;return this.coa.getPlan().subscribe(e=>{const i=e.map(r=>({code:r.code,label:r.intitule.toLowerCase()})),n=r=>s.reduce((u,g)=>u+(r.includes(g)?1:0),0),o=i.map(r=>({code:r.code,sc:n(r.label)})).filter(r=>r.sc>0).sort((r,u)=>u.sc-r.sc)[0];a=o?o.code:null}).unsubscribe(),a}addLine(){this.proposal.push({compte:"",libelle:"",debit:0,credit:0})}recalc(){this.totalDebit=this.proposal.reduce((s,a)=>s+(Number(a.debit)||0),0),this.totalCredit=this.proposal.reduce((s,a)=>s+(Number(a.credit)||0),0)}save(){this.error=this.ok="";try{this.js.addEcriture({date:this.date,journalCode:this.journalCode,piece:this.piece,reference:this.reference,lignes:this.proposal}),this.ok="\xc9criture enregistr\xe9e",this.proposal=[],this.recalc()}catch(s){this.error=s?.message||"Erreur"}}static{this.\u0275fac=function(a){return new(a||l)(t.rXU(F.x),t.rXU(R.p))}}static{this.\u0275cmp=t.VBU({type:l,selectors:[["app-ai-assistant"]],standalone:!0,features:[t.aNF],decls:121,vars:29,consts:[[1,"module-container"],[1,"toolbar"],["type","file","multiple","","accept","image/*,.pdf,.txt,.csv,.json",3,"change"],[1,"input",3,"ngModelChange","ngModel"],["value","fra"],["value","eng"],["value","eng+fra"],[1,"btn",3,"click","disabled"],[4,"ngIf"],[1,"row"],["rows","8","placeholder","Texte extrait ou collez votre texte ici...",1,"text",3,"ngModelChange","ngModel"],["placeholder","Indication (ex: facture prestation client, facture achat, virement banque)",1,"input",3,"ngModelChange","ngModel"],[1,"row","settings"],["placeholder","Nom de votre entreprise",1,"input","small",3,"ngModelChange","change","ngModel"],[1,"input",3,"ngModelChange","change","ngModel"],["value","DETECT"],["value","VENTE_PRESTATIONS"],["value","VENTE_MARCHANDISES"],["value","ACHAT_PRESTATIONS"],["value","ACHAT_MARCHANDISES"],["value","PAIE_SALAIRE"],["value","BANQUE_PAIEMENT"],["value","BANQUE_ENCAISSEMENT"],["type","number",1,"input","small",3,"ngModelChange","change","ngModel"],[1,"input","small",3,"ngModelChange","change","ngModel"],[1,"meta-block"],[1,"meta-grid"],["type","date",1,"input",3,"ngModelChange","ngModel"],["placeholder","XOF/EUR/FCFA",1,"input","small",3,"ngModelChange","ngModel"],["type","number","step","0.01",1,"input",3,"ngModelChange","ngModel"],[1,"table"],[4,"ngFor","ngForOf"],[1,"btn",3,"click"],["class","err",4,"ngIf"],["class","ok",4,"ngIf"],[1,"btn","danger",3,"click"],["value","ACH"],["value","VEN"],["value","BNK"],["value","OD"],["value","SAL"],["value","CSH"],["value","MNE"],["placeholder","Pi\xe8ce",1,"input",3,"ngModelChange","ngModel"],["placeholder","R\xe9f\xe9rence",1,"input",3,"ngModelChange","ngModel"],["colspan","2"],["placeholder","ex: 706",1,"input",3,"ngModelChange","ngModel"],["type","number","step","0.01",1,"input",3,"ngModelChange","input","ngModel"],[1,"err"],[1,"ok"]],template:function(a,e){1&a&&(t.j41(0,"div",0)(1,"h1"),t.EFF(2,"\u{1f916} Assistant IA"),t.k0s(),t.j41(3,"div",1)(4,"input",2),t.bIt("change",function(n){return e.onFiles(n)}),t.k0s(),t.j41(5,"select",3),t.mxI("ngModelChange",function(n){return t.DH7(e.language,n)||(e.language=n),n}),t.j41(6,"option",4),t.EFF(7,"Fran\xe7ais"),t.k0s(),t.j41(8,"option",5),t.EFF(9,"Anglais"),t.k0s(),t.j41(10,"option",6),t.EFF(11,"Anglais + Fran\xe7ais"),t.k0s()(),t.j41(12,"button",7),t.bIt("click",function(){return e.runOcr()}),t.EFF(13,"Lancer l'OCR"),t.k0s(),t.DNE(14,I,3,4,"span",8),t.k0s(),t.j41(15,"div",9)(16,"textarea",10),t.mxI("ngModelChange",function(n){return t.DH7(e.extracted,n)||(e.extracted=n),n}),t.k0s()(),t.j41(17,"div",9)(18,"input",11),t.mxI("ngModelChange",function(n){return t.DH7(e.hint,n)||(e.hint=n),n}),t.k0s()(),t.j41(19,"div",12)(20,"label"),t.EFF(21,"Votre entreprise"),t.j41(22,"input",13),t.mxI("ngModelChange",function(n){return t.DH7(e.yourCompany,n)||(e.yourCompany=n),n}),t.bIt("change",function(){return e.saveSettings()}),t.k0s()(),t.j41(23,"label"),t.EFF(24,"Type d'op\xe9ration "),t.j41(25,"select",14),t.mxI("ngModelChange",function(n){return t.DH7(e.operationType,n)||(e.operationType=n),n}),t.bIt("change",function(){return e.saveSettings()}),t.j41(26,"option",15),t.EFF(27,"D\xe9tection automatique"),t.k0s(),t.j41(28,"option",16),t.EFF(29,"Vente \u2014 Prestations"),t.k0s(),t.j41(30,"option",17),t.EFF(31,"Vente \u2014 Marchandises"),t.k0s(),t.j41(32,"option",18),t.EFF(33,"Achat \u2014 Prestations"),t.k0s(),t.j41(34,"option",19),t.EFF(35,"Achat \u2014 Marchandises"),t.k0s(),t.j41(36,"option",20),t.EFF(37,"Paie \u2014 Salaire"),t.k0s(),t.j41(38,"option",21),t.EFF(39,"Banque \u2014 Paiement"),t.k0s(),t.j41(40,"option",22),t.EFF(41,"Banque \u2014 Encaissement"),t.k0s()()(),t.j41(42,"label"),t.EFF(43,"TVA (%)"),t.j41(44,"input",23),t.mxI("ngModelChange",function(n){return t.DH7(e.tvaRate,n)||(e.tvaRate=n),n}),t.bIt("change",function(){return e.saveSettings()}),t.k0s()(),t.j41(45,"label"),t.EFF(46,"TVA collect\xe9e"),t.j41(47,"input",24),t.mxI("ngModelChange",function(n){return t.DH7(e.acctTvaCollecte,n)||(e.acctTvaCollecte=n),n}),t.bIt("change",function(){return e.saveSettings()}),t.k0s()(),t.j41(48,"label"),t.EFF(49,"TVA d\xe9ductible"),t.j41(50,"input",24),t.mxI("ngModelChange",function(n){return t.DH7(e.acctTvaDeductible,n)||(e.acctTvaDeductible=n),n}),t.bIt("change",function(){return e.saveSettings()}),t.k0s()(),t.j41(51,"label"),t.EFF(52,"Vente prestations"),t.j41(53,"input",24),t.mxI("ngModelChange",function(n){return t.DH7(e.acctVentePrestations,n)||(e.acctVentePrestations=n),n}),t.bIt("change",function(){return e.saveSettings()}),t.k0s()(),t.j41(54,"label"),t.EFF(55,"Vente marchandises"),t.j41(56,"input",24),t.mxI("ngModelChange",function(n){return t.DH7(e.acctVenteMarchandises,n)||(e.acctVenteMarchandises=n),n}),t.bIt("change",function(){return e.saveSettings()}),t.k0s()(),t.j41(57,"label"),t.EFF(58,"Achat prestations"),t.j41(59,"input",24),t.mxI("ngModelChange",function(n){return t.DH7(e.acctAchatPrestations,n)||(e.acctAchatPrestations=n),n}),t.bIt("change",function(){return e.saveSettings()}),t.k0s()(),t.j41(60,"label"),t.EFF(61,"Achat marchandises"),t.j41(62,"input",24),t.mxI("ngModelChange",function(n){return t.DH7(e.acctAchatMarchandises,n)||(e.acctAchatMarchandises=n),n}),t.bIt("change",function(){return e.saveSettings()}),t.k0s()()(),t.j41(63,"div",25)(64,"h3"),t.EFF(65,"Donn\xe9es d\xe9tect\xe9es"),t.k0s(),t.j41(66,"div",26)(67,"label"),t.EFF(68,"\xc9metteur"),t.j41(69,"input",3),t.mxI("ngModelChange",function(n){return t.DH7(e.meta.issuer,n)||(e.meta.issuer=n),n}),t.k0s()(),t.j41(70,"label"),t.EFF(71,"Destinataire"),t.j41(72,"input",3),t.mxI("ngModelChange",function(n){return t.DH7(e.meta.recipient,n)||(e.meta.recipient=n),n}),t.k0s()(),t.j41(73,"label"),t.EFF(74,"Objet"),t.j41(75,"input",3),t.mxI("ngModelChange",function(n){return t.DH7(e.meta.subject,n)||(e.meta.subject=n),n}),t.k0s()(),t.j41(76,"label"),t.EFF(77,"Type"),t.j41(78,"input",3),t.mxI("ngModelChange",function(n){return t.DH7(e.meta.docType,n)||(e.meta.docType=n),n}),t.k0s()(),t.j41(79,"label"),t.EFF(80,"Num\xe9ro"),t.j41(81,"input",3),t.mxI("ngModelChange",function(n){return t.DH7(e.meta.invoiceNumber,n)||(e.meta.invoiceNumber=n),n}),t.k0s()(),t.j41(82,"label"),t.EFF(83,"Date"),t.j41(84,"input",27),t.mxI("ngModelChange",function(n){return t.DH7(e.meta.date,n)||(e.meta.date=n),n}),t.k0s()(),t.j41(85,"label"),t.EFF(86,"\xc9ch\xe9ance"),t.j41(87,"input",27),t.mxI("ngModelChange",function(n){return t.DH7(e.meta.dueDate,n)||(e.meta.dueDate=n),n}),t.k0s()(),t.j41(88,"label"),t.EFF(89,"Devise"),t.j41(90,"input",28),t.mxI("ngModelChange",function(n){return t.DH7(e.meta.currency,n)||(e.meta.currency=n),n}),t.k0s()()(),t.j41(91,"div",26)(92,"label"),t.EFF(93,"Total HT"),t.j41(94,"input",29),t.mxI("ngModelChange",function(n){return t.DH7(e.meta.totals.ht,n)||(e.meta.totals.ht=n),n}),t.k0s()(),t.j41(95,"label"),t.EFF(96,"TVA"),t.j41(97,"input",29),t.mxI("ngModelChange",function(n){return t.DH7(e.meta.totals.tva,n)||(e.meta.totals.tva=n),n}),t.k0s()(),t.j41(98,"label"),t.EFF(99,"Total TTC"),t.j41(100,"input",29),t.mxI("ngModelChange",function(n){return t.DH7(e.meta.totals.ttc,n)||(e.meta.totals.ttc=n),n}),t.k0s()()(),t.j41(101,"h4"),t.EFF(102,"Lignes d\xe9tect\xe9es"),t.k0s(),t.j41(103,"table",30)(104,"thead")(105,"tr")(106,"th"),t.EFF(107,"D\xe9signation"),t.k0s(),t.j41(108,"th"),t.EFF(109,"Montant"),t.k0s(),t.nrm(110,"th"),t.k0s()(),t.j41(111,"tbody"),t.DNE(112,k,8,2,"tr",31),t.k0s()(),t.j41(113,"button",32),t.bIt("click",function(){return e.meta.items.push({label:"",amount:0})}),t.EFF(114,"Ajouter ligne"),t.k0s()(),t.j41(115,"div",9)(116,"button",32),t.bIt("click",function(){return e.proposeEntries()}),t.EFF(117,"Proposer des \xe9critures"),t.k0s()(),t.DNE(118,N,61,18,"div",8)(119,P,2,1,"div",33)(120,S,2,1,"div",34),t.k0s()),2&a&&(t.R7$(5),t.R50("ngModel",e.language),t.R7$(7),t.Y8G("disabled",!e.files.length||e.ocrRunning),t.R7$(2),t.Y8G("ngIf",e.ocrRunning),t.R7$(2),t.R50("ngModel",e.extracted),t.R7$(2),t.R50("ngModel",e.hint),t.R7$(4),t.R50("ngModel",e.yourCompany),t.R7$(3),t.R50("ngModel",e.operationType),t.R7$(19),t.R50("ngModel",e.tvaRate),t.R7$(3),t.R50("ngModel",e.acctTvaCollecte),t.R7$(3),t.R50("ngModel",e.acctTvaDeductible),t.R7$(3),t.R50("ngModel",e.acctVentePrestations),t.R7$(3),t.R50("ngModel",e.acctVenteMarchandises),t.R7$(3),t.R50("ngModel",e.acctAchatPrestations),t.R7$(3),t.R50("ngModel",e.acctAchatMarchandises),t.R7$(7),t.R50("ngModel",e.meta.issuer),t.R7$(3),t.R50("ngModel",e.meta.recipient),t.R7$(3),t.R50("ngModel",e.meta.subject),t.R7$(3),t.R50("ngModel",e.meta.docType),t.R7$(3),t.R50("ngModel",e.meta.invoiceNumber),t.R7$(3),t.R50("ngModel",e.meta.date),t.R7$(3),t.R50("ngModel",e.meta.dueDate),t.R7$(3),t.R50("ngModel",e.meta.currency),t.R7$(4),t.R50("ngModel",e.meta.totals.ht),t.R7$(3),t.R50("ngModel",e.meta.totals.tva),t.R7$(3),t.R50("ngModel",e.meta.totals.ttc),t.R7$(12),t.Y8G("ngForOf",e.meta.items),t.R7$(6),t.Y8G("ngIf",e.proposal.length),t.R7$(),t.Y8G("ngIf",e.error),t.R7$(),t.Y8G("ngIf",e.ok))},dependencies:[b.MD,b.Sq,b.bT,b.QX,C.YN,C.xH,C.y7,C.me,C.Q0,C.wz,C.BC,C.vS],styles:[".module-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:24px;box-shadow:0 4px 16px #00000014}.toolbar[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap;align-items:center;margin:8px 0}.row[_ngcontent-%COMP%]{margin:8px 0}.settings[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap;align-items:center}.input[_ngcontent-%COMP%]{padding:8px 10px;border:1px solid #e2e8f0;border-radius:6px}.input.small[_ngcontent-%COMP%]{width:180px}.btn[_ngcontent-%COMP%]{padding:8px 10px;border:none;border-radius:6px;background:#3182ce;color:#fff;cursor:pointer}.btn.danger[_ngcontent-%COMP%]{background:#e53e3e}.text[_ngcontent-%COMP%]{width:100%;min-height:160px;padding:10px;border:1px solid #e2e8f0;border-radius:6px;font-family:ui-monospace,monospace}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #e2e8f0;padding:8px 10px;text-align:left}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f7fafc}.meta-block[_ngcontent-%COMP%]{border:1px solid #e2e8f0;border-radius:8px;padding:12px;margin:8px 0}.meta-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,minmax(180px,1fr));gap:8px;margin-bottom:8px}.err[_ngcontent-%COMP%]{color:#e53e3e;margin-top:8px}.ok[_ngcontent-%COMP%]{color:#38a169;margin-top:8px}"]})}}return l})()}}]);