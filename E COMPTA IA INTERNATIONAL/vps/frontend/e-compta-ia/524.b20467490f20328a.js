"use strict";(self.webpackChunke_compta_ia=self.webpackChunke_compta_ia||[]).push([[524],{8317:(_,u,a)=>{a.r(u),a.d(u,{LedgersComponent:()=>E});var p=a(177),m=a(4341),e=a(4438),h=a(1941);function F(s,b){if(1&s&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.j41(11,"td"),e.EFF(12),e.nI1(13,"number"),e.k0s(),e.j41(14,"td"),e.EFF(15),e.nI1(16,"number"),e.k0s(),e.j41(17,"td"),e.EFF(18),e.nI1(19,"number"),e.k0s()()),2&s){const t=b.$implicit;e.R7$(2),e.JRh(t.date),e.R7$(2),e.JRh(t.journal),e.R7$(2),e.JRh(t.piece),e.R7$(2),e.JRh(t.reference),e.R7$(2),e.JRh(t.libelle),e.R7$(2),e.JRh(e.i5U(13,8,t.debit,"1.2-2")),e.R7$(3),e.JRh(e.i5U(16,11,t.credit,"1.2-2")),e.R7$(3),e.JRh(e.i5U(19,14,t.balance,"1.2-2"))}}function f(s,b){if(1&s&&(e.j41(0,"div",7)(1,"div",8),e.EFF(2,"Solde initial: "),e.j41(3,"b"),e.EFF(4),e.nI1(5,"number"),e.k0s(),e.EFF(6," \u2014 Solde courant: "),e.j41(7,"b"),e.EFF(8),e.nI1(9,"number"),e.k0s()(),e.j41(10,"table",9)(11,"thead")(12,"tr")(13,"th"),e.EFF(14,"Date"),e.k0s(),e.j41(15,"th"),e.EFF(16,"Journal"),e.k0s(),e.j41(17,"th"),e.EFF(18,"Pi\xe8ce"),e.k0s(),e.j41(19,"th"),e.EFF(20,"R\xe9f"),e.k0s(),e.j41(21,"th"),e.EFF(22,"Libell\xe9"),e.k0s(),e.j41(23,"th"),e.EFF(24,"D\xe9bit"),e.k0s(),e.j41(25,"th"),e.EFF(26,"Cr\xe9dit"),e.k0s(),e.j41(27,"th"),e.EFF(28,"Solde"),e.k0s()()(),e.j41(29,"tbody"),e.DNE(30,F,20,17,"tr",10),e.k0s()()()),2&s){const t=e.XpG();e.R7$(4),e.JRh(e.i5U(5,3,t.opening,"1.2-2")),e.R7$(4),e.JRh(e.i5U(9,6,t.current,"1.2-2")),e.R7$(22),e.Y8G("ngForOf",t.lines)}}let E=(()=>{class s{constructor(t){this.js=t,this.compte="",this.from=new Date((new Date).getFullYear(),0,1).toISOString().slice(0,10),this.to=(new Date).toISOString().slice(0,10),this.lines=[],this.opening=0,this.current=0}compute(){const t=this.js.ecritures$?.value||[],c=this.from,o=this.to,l=(this.compte||"").trim();let n=0;const r=[];for(const i of t)for(const d of i.lignes)if(!l||d.compte===l){if(i.date<c){n+=(Number(d.debit)||0)-(Number(d.credit)||0);continue}i.date>o||r.push({date:i.date,journal:i.journalCode,piece:i.piece,reference:i.reference,libelle:d.libelle,debit:Number(d.debit)||0,credit:Number(d.credit)||0,balance:0})}r.sort((i,d)=>i.date.localeCompare(d.date));let g=n;for(const i of r)g+=i.debit-i.credit,i.balance=g;this.opening=n,this.current=g,this.lines=r}exportCsv(){const c=this.lines.map(r=>[r.date,r.journal,r.piece||"",r.reference||"",this.csv(r.libelle),r.debit,r.credit,r.balance].join(";")),o=new Blob(["\ufeff"+["date;journal;piece;reference;libelle;debit;credit;solde",...c].join("\n")],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(o),n=document.createElement("a");n.href=l,n.download="grand-livre.csv",n.click(),URL.revokeObjectURL(l)}csv(t){return t?.includes(";")||t?.includes('"')?'"'+t.replace(/"/g,'""')+'"':t}static{this.\u0275fac=function(c){return new(c||s)(e.rXU(h.p))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-ledgers"]],standalone:!0,features:[e.aNF],decls:18,vars:5,consts:[[1,"module-container"],[1,"toolbar"],["placeholder","Ex: 601, 445, 512",1,"input",3,"ngModelChange","ngModel"],["type","date",1,"input",3,"ngModelChange","ngModel"],[1,"btn",3,"click"],[1,"btn",3,"click","disabled"],["class","panel",4,"ngIf"],[1,"panel"],[1,"row"],[1,"table"],[4,"ngFor","ngForOf"]],template:function(c,o){1&c&&(e.j41(0,"div",0)(1,"h1"),e.EFF(2,"\u{1f4da} Grands Livres"),e.k0s(),e.j41(3,"div",1)(4,"label"),e.EFF(5,"Compte"),e.j41(6,"input",2),e.mxI("ngModelChange",function(n){return e.DH7(o.compte,n)||(o.compte=n),n}),e.k0s()(),e.j41(7,"label"),e.EFF(8,"Du "),e.j41(9,"input",3),e.mxI("ngModelChange",function(n){return e.DH7(o.from,n)||(o.from=n),n}),e.k0s()(),e.j41(10,"label"),e.EFF(11,"Au "),e.j41(12,"input",3),e.mxI("ngModelChange",function(n){return e.DH7(o.to,n)||(o.to=n),n}),e.k0s()(),e.j41(13,"button",4),e.bIt("click",function(){return o.compute()}),e.EFF(14,"Afficher"),e.k0s(),e.j41(15,"button",5),e.bIt("click",function(){return o.exportCsv()}),e.EFF(16,"Export CSV"),e.k0s()(),e.DNE(17,f,31,9,"div",6),e.k0s()),2&c&&(e.R7$(6),e.R50("ngModel",o.compte),e.R7$(3),e.R50("ngModel",o.from),e.R7$(3),e.R50("ngModel",o.to),e.R7$(3),e.Y8G("disabled",!o.lines.length),e.R7$(2),e.Y8G("ngIf",o.lines.length))},dependencies:[p.MD,p.Sq,p.bT,p.QX,m.YN,m.me,m.BC,m.vS],styles:[".module-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;box-shadow:0 4px 16px #00000014}.toolbar[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center;margin-bottom:8px}.input[_ngcontent-%COMP%]{padding:8px 10px;border:1px solid #e2e8f0;border-radius:6px}.btn[_ngcontent-%COMP%]{padding:8px 10px;border:none;border-radius:6px;background:#3182ce;color:#fff;cursor:pointer}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #e2e8f0;padding:8px 10px;text-align:left}.panel[_ngcontent-%COMP%]{border:1px solid #e2e8f0;border-radius:8px;padding:12px;margin-top:8px}"]})}}return s})()},5312:(_,u,a)=>{a.d(u,{c:()=>p});const p={production:!1,name:"development",amplify:{region:"us-west-2",apiUrl:"https://dev-api.e-compta-ia.com",cognitoDomain:"dev-auth.e-compta-ia.com"},apiUrl:"https://e-compta-ia-backend.dev",app:{name:"E-COMPTA-IA",version:"1.0.0",description:"Plateforme Comptable SYSCOHADA avec IA"}}}}]);