"use strict";(self.webpackChunke_compta_ia=self.webpackChunke_compta_ia||[]).push([[268],{9845:(x,_,l)=>{l.r(_),l.d(_,{TaxDeclarationsComponent:()=>B});var g=l(467),d=l(177),u=l(4341),t=l(4438);let j=(()=>{class r{transform(n,i){return i?n.filter(e=>e.type===i):n}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275pipe=t.EJ8({name:"typeFilter",type:r,pure:!0,standalone:!0})}}return r})();var F=l(4412);let b=(()=>{class r{constructor(){this.storageKey="ecompta_declarations_v1",this.records$=new F.t(this.load())}getAll(){return this.records$.asObservable()}add(n){const i=`${n.type}-${Date.now()}`,e=(new Date).toISOString(),a=n.category||this.categoryForType(n.type),o=[...this.records$.value,{...n,id:i,createdAt:e,category:a}];this.records$.next(o),this.persist(o)}update(n,i){const e=this.records$.value.map(a=>a.id===n?{...a,...i}:a);this.records$.next(e),this.persist(e)}remove(n){const i=this.records$.value.filter(e=>e.id!==n);this.records$.next(i),this.persist(i)}exportCsv(n,i){const a=this.records$.value.filter(o=>!n||o.type===n).filter(o=>!i||o.category===i).map(o=>[o.id,o.category,o.type,o.period,o.year,o.amountDue,o.status,o.createdAt,this.escape(JSON.stringify(o.data||{}))].join(";"));return new Blob(["\ufeff"+[["id","category","type","period","year","amountDue","status","createdAt","data"].join(";"),...a].join("\n")],{type:"text/csv;charset=utf-8;"})}importCsv(n){const i=n.split(/\r?\n/).filter(o=>o.trim());if(i.length<2)return{imported:0,errors:["Fichier vide"]};const e=[...this.records$.value],a=[];for(let o=1;o<i.length;o++){const s=this.splitCsv(i[o]);try{const[p,G,h,C,X,H,O,U,P]=s,m="CNPS"===h?"CNSS":h,L=G||this.categoryForType(m);if(!m||!C)throw new Error("Colonnes manquantes");e.push({id:p||`imp-${Date.now()}-${o}`,category:L,type:m,period:C,year:Number(X)||0,amountDue:Number(H)||0,status:O||"BROUILLON",createdAt:U||(new Date).toISOString(),data:this.safeParse(P)})}catch(p){a.push(`Ligne ${o+1}: ${p?.message||p}`)}}return this.records$.next(e),this.persist(e),{imported:i.length-1-a.length,errors:a}}categoryForType(n){const i=String(n).toUpperCase();return"TVA"===i||"IS"===i||"IUTS"===i||"BIC"===i?"FISCAL":"CNSS"===i||"CNPS"===i?"SOCIAL":"AUTRES"}persist(n){try{localStorage.setItem(this.storageKey,JSON.stringify(n))}catch{}}load(){try{const n=localStorage.getItem(this.storageKey);return(n?JSON.parse(n):[]).map(e=>{const a="CNPS"===e.type?"CNSS":e.type||"AUTRE";return{category:e.category||this.categoryForType(a),...e,type:a}})}catch{return[]}}escape(n){return n.includes(";")||n.includes('"')?'"'+n.replace(/"/g,'""')+'"':n}splitCsv(n){const i=[];let e="",a=!1;for(let o=0;o<n.length;o++){const s=n[o];'"'===s?a&&'"'===n[o+1]?(e+='"',o++):a=!a:";"!==s||a?e+=s:(i.push(e),e="")}return i.push(e),i}safeParse(n){try{return n?JSON.parse(n):{}}catch{return{}}}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var T=l(1941),f=l(4913);function E(r,c){if(1&r&&(t.j41(0,"div",19),t.EFF(1," Pays: "),t.j41(2,"b"),t.EFF(3),t.k0s(),t.EFF(4),t.j41(5,"b"),t.EFF(6),t.k0s()()),2&r){const n=t.XpG();t.R7$(3),t.JRh(n.selectedCountryName),t.R7$(),t.SpI(" (",n.selectedCountryCode,") \u2014 Devise: "),t.R7$(2),t.JRh(n.selectedCurrency)}}function D(r,c){if(1&r&&(t.j41(0,"div",19),t.EFF(1," Taux standard: "),t.j41(2,"b"),t.EFF(3),t.k0s(),t.EFF(4," \xa0|\xa0 D\xe9lais: "),t.j41(5,"b"),t.EFF(6),t.k0s()()),2&r){const n=t.XpG(3);t.R7$(3),t.SpI("",n.taxInfo.vat.standardRate,"%"),t.R7$(3),t.JRh(n.taxInfo.vat.paymentDeadline)}}function v(r,c){if(1&r){const n=t.RV6();t.j41(0,"div",22)(1,"h3"),t.EFF(2,"D\xe9claration TVA"),t.k0s(),t.DNE(3,D,7,2,"div",1),t.j41(4,"div",23)(5,"label"),t.EFF(6,"P\xe9riode (AAAA-MM)"),t.j41(7,"input",24),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.tva.period,e)||(a.tva.period=e),t.Njj(e)}),t.k0s()(),t.j41(8,"label"),t.EFF(9,"Ann\xe9e"),t.j41(10,"input",25),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.tva.year,e)||(a.tva.year=e),t.Njj(e)}),t.k0s()(),t.j41(11,"label"),t.EFF(12,"CA HT ventes"),t.j41(13,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.tva.caHt,e)||(a.tva.caHt=e),t.Njj(e)}),t.k0s()(),t.j41(14,"label"),t.EFF(15,"TVA collect\xe9e"),t.j41(16,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.tva.tvaCollecte,e)||(a.tva.tvaCollecte=e),t.Njj(e)}),t.k0s()(),t.j41(17,"label"),t.EFF(18,"Achat HT"),t.j41(19,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.tva.achatHt,e)||(a.tva.achatHt=e),t.Njj(e)}),t.k0s()(),t.j41(20,"label"),t.EFF(21,"TVA d\xe9ductible"),t.j41(22,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.tva.tvaDeductible,e)||(a.tva.tvaDeductible=e),t.Njj(e)}),t.k0s()(),t.j41(23,"label"),t.EFF(24,"Journal"),t.j41(25,"input",27),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.tva.journal,e)||(a.tva.journal=e),t.Njj(e)}),t.k0s()(),t.j41(26,"label"),t.EFF(27,"Compte TVA collect\xe9e"),t.j41(28,"input",28),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.tva.acctCollecte,e)||(a.tva.acctCollecte=e),t.Njj(e)}),t.k0s()(),t.j41(29,"label"),t.EFF(30,"Compte TVA d\xe9ductible"),t.j41(31,"input",29),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.tva.acctDeductible,e)||(a.tva.acctDeductible=e),t.Njj(e)}),t.k0s()()(),t.j41(32,"div",30)(33,"span"),t.EFF(34,"TVA \xe0 payer: "),t.j41(35,"b"),t.EFF(36),t.nI1(37,"number"),t.k0s()(),t.j41(38,"button",15),t.bIt("click",function(){t.eBV(n);const e=t.XpG(2);return t.Njj(e.save("TVA",e.tvaDue(),e.tva,"FISCAL"))}),t.EFF(39,"Enregistrer"),t.k0s(),t.j41(40,"button",15),t.bIt("click",function(){t.eBV(n);const e=t.XpG(2);return t.Njj(e.genEcritureTVA())}),t.EFF(41,"G\xe9n\xe9rer \xe9criture"),t.k0s()()()}if(2&r){const n=t.XpG(2);t.R7$(3),t.Y8G("ngIf",null==n.taxInfo?null:n.taxInfo.vat),t.R7$(4),t.R50("ngModel",n.tva.period),t.R7$(3),t.R50("ngModel",n.tva.year),t.R7$(3),t.R50("ngModel",n.tva.caHt),t.R7$(3),t.R50("ngModel",n.tva.tvaCollecte),t.R7$(3),t.R50("ngModel",n.tva.achatHt),t.R7$(3),t.R50("ngModel",n.tva.tvaDeductible),t.R7$(3),t.R50("ngModel",n.tva.journal),t.R7$(3),t.R50("ngModel",n.tva.acctCollecte),t.R7$(3),t.R50("ngModel",n.tva.acctDeductible),t.R7$(5),t.JRh(t.i5U(37,11,n.tvaDue(),"1.2-2"))}}function M(r,c){if(1&r&&(t.j41(0,"div",19),t.EFF(1," Taux par d\xe9faut: "),t.j41(2,"b"),t.EFF(3),t.k0s(),t.EFF(4," \xa0|\xa0 \xc9ch\xe9ance: "),t.j41(5,"b"),t.EFF(6),t.k0s()()),2&r){const n=t.XpG(3);t.R7$(3),t.SpI("",n.taxInfo.corporateIncomeTax.rate,"%"),t.R7$(3),t.JRh(n.taxInfo.corporateIncomeTax.paymentDeadline)}}function I(r,c){if(1&r){const n=t.RV6();t.j41(0,"div",22)(1,"h3"),t.EFF(2,"D\xe9claration IS"),t.k0s(),t.DNE(3,M,7,2,"div",1),t.j41(4,"div",23)(5,"label"),t.EFF(6,"Ann\xe9e"),t.j41(7,"input",25),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.is.year,e)||(a.is.year=e),t.Njj(e)}),t.k0s()(),t.j41(8,"label"),t.EFF(9,"R\xe9sultat fiscal"),t.j41(10,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.is.resultat,e)||(a.is.resultat=e),t.Njj(e)}),t.k0s()(),t.j41(11,"label"),t.EFF(12,"Taux (%)"),t.j41(13,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.is.taux,e)||(a.is.taux=e),t.Njj(e)}),t.k0s()(),t.j41(14,"label"),t.EFF(15,"Journal"),t.j41(16,"input",31),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.is.journal,e)||(a.is.journal=e),t.Njj(e)}),t.k0s()(),t.j41(17,"label"),t.EFF(18,"Compte Imp\xf4t"),t.j41(19,"input",32),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.is.acct,e)||(a.is.acct=e),t.Njj(e)}),t.k0s()()(),t.j41(20,"div",30)(21,"span"),t.EFF(22,"IS d\xfb: "),t.j41(23,"b"),t.EFF(24),t.nI1(25,"number"),t.k0s()(),t.j41(26,"button",15),t.bIt("click",function(){t.eBV(n);const e=t.XpG(2);return t.Njj(e.save("IS",e.isDue(),e.is,"FISCAL"))}),t.EFF(27,"Enregistrer"),t.k0s(),t.j41(28,"button",15),t.bIt("click",function(){t.eBV(n);const e=t.XpG(2);return t.Njj(e.genEcritureIS())}),t.EFF(29,"G\xe9n\xe9rer \xe9criture"),t.k0s()()()}if(2&r){const n=t.XpG(2);t.R7$(3),t.Y8G("ngIf",null==n.taxInfo?null:n.taxInfo.corporateIncomeTax),t.R7$(4),t.R50("ngModel",n.is.year),t.R7$(3),t.R50("ngModel",n.is.resultat),t.R7$(3),t.R50("ngModel",n.is.taux),t.R7$(3),t.R50("ngModel",n.is.journal),t.R7$(3),t.R50("ngModel",n.is.acct),t.R7$(5),t.JRh(t.i5U(25,7,n.isDue(),"1.2-2"))}}function y(r,c){if(1&r){const n=t.RV6();t.j41(0,"div",22)(1,"h3"),t.EFF(2,"IUTS"),t.k0s(),t.j41(3,"div",23)(4,"label"),t.EFF(5,"P\xe9riode"),t.j41(6,"input",6),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.iuts.period,e)||(a.iuts.period=e),t.Njj(e)}),t.k0s()(),t.j41(7,"label"),t.EFF(8,"Ann\xe9e"),t.j41(9,"input",25),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.iuts.year,e)||(a.iuts.year=e),t.Njj(e)}),t.k0s()(),t.j41(10,"label"),t.EFF(11,"Base imposable"),t.j41(12,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.iuts.base,e)||(a.iuts.base=e),t.Njj(e)}),t.k0s()(),t.j41(13,"label"),t.EFF(14,"Taux (%)"),t.j41(15,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.iuts.taux,e)||(a.iuts.taux=e),t.Njj(e)}),t.k0s()(),t.j41(16,"label"),t.EFF(17,"Journal"),t.j41(18,"input",31),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.iuts.journal,e)||(a.iuts.journal=e),t.Njj(e)}),t.k0s()(),t.j41(19,"label"),t.EFF(20,"Compte IUTS"),t.j41(21,"input",33),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.iuts.acct,e)||(a.iuts.acct=e),t.Njj(e)}),t.k0s()()(),t.j41(22,"div",30)(23,"span"),t.EFF(24,"IUTS d\xfb: "),t.j41(25,"b"),t.EFF(26),t.nI1(27,"number"),t.k0s()(),t.j41(28,"button",15),t.bIt("click",function(){t.eBV(n);const e=t.XpG(2);return t.Njj(e.save("AUTRE",e.iutsDue(),e.iuts,"FISCAL"))}),t.EFF(29,"Enregistrer"),t.k0s(),t.j41(30,"button",15),t.bIt("click",function(){t.eBV(n);const e=t.XpG(2);return t.Njj(e.genEcritureIUTS())}),t.EFF(31,"G\xe9n\xe9rer \xe9criture"),t.k0s()()()}if(2&r){const n=t.XpG(2);t.R7$(6),t.R50("ngModel",n.iuts.period),t.R7$(3),t.R50("ngModel",n.iuts.year),t.R7$(3),t.R50("ngModel",n.iuts.base),t.R7$(3),t.R50("ngModel",n.iuts.taux),t.R7$(3),t.R50("ngModel",n.iuts.journal),t.R7$(3),t.R50("ngModel",n.iuts.acct),t.R7$(5),t.JRh(t.i5U(27,7,n.iutsDue(),"1.2-2"))}}function R(r,c){if(1&r){const n=t.RV6();t.j41(0,"div",22)(1,"h3"),t.EFF(2,"BIC"),t.k0s(),t.j41(3,"div",23)(4,"label"),t.EFF(5,"P\xe9riode"),t.j41(6,"input",6),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.bic.period,e)||(a.bic.period=e),t.Njj(e)}),t.k0s()(),t.j41(7,"label"),t.EFF(8,"Ann\xe9e"),t.j41(9,"input",25),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.bic.year,e)||(a.bic.year=e),t.Njj(e)}),t.k0s()(),t.j41(10,"label"),t.EFF(11,"Base"),t.j41(12,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.bic.base,e)||(a.bic.base=e),t.Njj(e)}),t.k0s()(),t.j41(13,"label"),t.EFF(14,"Taux (%)"),t.j41(15,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.bic.taux,e)||(a.bic.taux=e),t.Njj(e)}),t.k0s()(),t.j41(16,"label"),t.EFF(17,"Journal"),t.j41(18,"input",31),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.bic.journal,e)||(a.bic.journal=e),t.Njj(e)}),t.k0s()(),t.j41(19,"label"),t.EFF(20,"Compte BIC"),t.j41(21,"input",32),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.bic.acct,e)||(a.bic.acct=e),t.Njj(e)}),t.k0s()()(),t.j41(22,"div",30)(23,"span"),t.EFF(24,"BIC d\xfb: "),t.j41(25,"b"),t.EFF(26),t.nI1(27,"number"),t.k0s()(),t.j41(28,"button",15),t.bIt("click",function(){t.eBV(n);const e=t.XpG(2);return t.Njj(e.save("AUTRE",e.bicDue(),e.bic,"FISCAL"))}),t.EFF(29,"Enregistrer"),t.k0s(),t.j41(30,"button",15),t.bIt("click",function(){t.eBV(n);const e=t.XpG(2);return t.Njj(e.genEcritureBIC())}),t.EFF(31,"G\xe9n\xe9rer \xe9criture"),t.k0s()()()}if(2&r){const n=t.XpG(2);t.R7$(6),t.R50("ngModel",n.bic.period),t.R7$(3),t.R50("ngModel",n.bic.year),t.R7$(3),t.R50("ngModel",n.bic.base),t.R7$(3),t.R50("ngModel",n.bic.taux),t.R7$(3),t.R50("ngModel",n.bic.journal),t.R7$(3),t.R50("ngModel",n.bic.acct),t.R7$(5),t.JRh(t.i5U(27,7,n.bicDue(),"1.2-2"))}}function k(r,c){if(1&r){const n=t.RV6();t.j41(0,"div")(1,"div",20)(2,"button",3),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.active="TVA")}),t.EFF(3,"TVA"),t.k0s(),t.j41(4,"button",3),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.active="IS")}),t.EFF(5,"IS"),t.k0s(),t.j41(6,"button",3),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.active="IUTS")}),t.EFF(7,"IUTS"),t.k0s(),t.j41(8,"button",3),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.active="BIC")}),t.EFF(9,"BIC"),t.k0s()(),t.DNE(10,v,42,14,"div",21)(11,I,30,10,"div",21)(12,y,32,10,"div",21)(13,R,32,10,"div",21),t.k0s()}if(2&r){const n=t.XpG();t.R7$(2),t.AVh("active","TVA"===n.active),t.R7$(2),t.AVh("active","IS"===n.active),t.R7$(2),t.AVh("active","IUTS"===n.active),t.R7$(2),t.AVh("active","BIC"===n.active),t.R7$(2),t.Y8G("ngIf","TVA"===n.active),t.R7$(),t.Y8G("ngIf","IS"===n.active),t.R7$(),t.Y8G("ngIf","IUTS"===n.active),t.R7$(),t.Y8G("ngIf","BIC"===n.active)}}function S(r,c){if(1&r&&(t.j41(0,"div",19),t.EFF(1," Taux employeur: "),t.j41(2,"b"),t.EFF(3),t.k0s(),t.EFF(4," \xa0|\xa0 Taux salari\xe9: "),t.j41(5,"b"),t.EFF(6),t.k0s()()),2&r){const n=t.XpG(2);t.R7$(3),t.SpI("",null==n.taxInfo.socialContributions.employer?null:n.taxInfo.socialContributions.employer.rate,"%"),t.R7$(3),t.SpI("",null==n.taxInfo.socialContributions.employee?null:n.taxInfo.socialContributions.employee.rate,"%")}}function N(r,c){if(1&r){const n=t.RV6();t.j41(0,"div")(1,"div",22)(2,"h3"),t.EFF(3,"D\xe9claration CNSS"),t.k0s(),t.DNE(4,S,7,2,"div",1),t.j41(5,"div",23)(6,"label"),t.EFF(7,"P\xe9riode (AAAA-MM)"),t.j41(8,"input",24),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.cnss.period,e)||(a.cnss.period=e),t.Njj(e)}),t.k0s()(),t.j41(9,"label"),t.EFF(10,"Ann\xe9e"),t.j41(11,"input",25),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.cnss.year,e)||(a.cnss.year=e),t.Njj(e)}),t.k0s()(),t.j41(12,"label"),t.EFF(13,"Masse salariale"),t.j41(14,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.cnss.masse,e)||(a.cnss.masse=e),t.Njj(e)}),t.k0s()(),t.j41(15,"label"),t.EFF(16,"Taux employeur (%)"),t.j41(17,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.cnss.tauxEmp,e)||(a.cnss.tauxEmp=e),t.Njj(e)}),t.k0s()(),t.j41(18,"label"),t.EFF(19,"Taux salari\xe9 (%)"),t.j41(20,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.cnss.tauxSal,e)||(a.cnss.tauxSal=e),t.Njj(e)}),t.k0s()(),t.j41(21,"label"),t.EFF(22,"Journal"),t.j41(23,"input",34),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.cnss.journal,e)||(a.cnss.journal=e),t.Njj(e)}),t.k0s()(),t.j41(24,"label"),t.EFF(25,"Compte charge employeur"),t.j41(26,"input",35),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.cnss.acctChargeEmp,e)||(a.cnss.acctChargeEmp=e),t.Njj(e)}),t.k0s()(),t.j41(27,"label"),t.EFF(28,"Compte retenue salari\xe9"),t.j41(29,"input",36),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.cnss.acctRetenueSal,e)||(a.cnss.acctRetenueSal=e),t.Njj(e)}),t.k0s()(),t.j41(30,"label"),t.EFF(31,"Compte CNSS"),t.j41(32,"input",37),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.cnss.acctCnss,e)||(a.cnss.acctCnss=e),t.Njj(e)}),t.k0s()()(),t.j41(33,"div",30)(34,"span"),t.EFF(35,"CNSS employeur: "),t.j41(36,"b"),t.EFF(37),t.nI1(38,"number"),t.k0s(),t.EFF(39," \xa0 CNSS salari\xe9: "),t.j41(40,"b"),t.EFF(41),t.nI1(42,"number"),t.k0s()(),t.j41(43,"button",15),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.save("CNSS",e.cnssEmpDue()+e.cnssSalDue(),e.cnss,"SOCIAL"))}),t.EFF(44,"Enregistrer"),t.k0s(),t.j41(45,"button",15),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.genEcritureCNSS())}),t.EFF(46,"G\xe9n\xe9rer \xe9criture"),t.k0s()()()()}if(2&r){const n=t.XpG();t.R7$(4),t.Y8G("ngIf",null==n.taxInfo?null:n.taxInfo.socialContributions),t.R7$(4),t.R50("ngModel",n.cnss.period),t.R7$(3),t.R50("ngModel",n.cnss.year),t.R7$(3),t.R50("ngModel",n.cnss.masse),t.R7$(3),t.R50("ngModel",n.cnss.tauxEmp),t.R7$(3),t.R50("ngModel",n.cnss.tauxSal),t.R7$(3),t.R50("ngModel",n.cnss.journal),t.R7$(3),t.R50("ngModel",n.cnss.acctChargeEmp),t.R7$(3),t.R50("ngModel",n.cnss.acctRetenueSal),t.R7$(3),t.R50("ngModel",n.cnss.acctCnss),t.R7$(5),t.JRh(t.i5U(38,12,n.cnssEmpDue(),"1.2-2")),t.R7$(4),t.JRh(t.i5U(42,15,n.cnssSalDue(),"1.2-2"))}}function A(r,c){if(1&r){const n=t.RV6();t.j41(0,"div")(1,"div",22)(2,"h3"),t.EFF(3,"Autres d\xe9clarations"),t.k0s(),t.j41(4,"div",23)(5,"label"),t.EFF(6,"Type"),t.j41(7,"input",38),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.autre.type,e)||(a.autre.type=e),t.Njj(e)}),t.k0s()(),t.j41(8,"label"),t.EFF(9,"P\xe9riode"),t.j41(10,"input",39),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.autre.period,e)||(a.autre.period=e),t.Njj(e)}),t.k0s()(),t.j41(11,"label"),t.EFF(12,"Ann\xe9e"),t.j41(13,"input",25),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.autre.year,e)||(a.autre.year=e),t.Njj(e)}),t.k0s()(),t.j41(14,"label"),t.EFF(15,"Montant d\xfb"),t.j41(16,"input",26),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.autre.amountDue,e)||(a.autre.amountDue=e),t.Njj(e)}),t.k0s()()(),t.j41(17,"div",30)(18,"button",15),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.save("AUTRE",e.autre.amountDue||0,e.autre,"AUTRES"))}),t.EFF(19,"Enregistrer"),t.k0s()()()()}if(2&r){const n=t.XpG();t.R7$(7),t.R50("ngModel",n.autre.type),t.R7$(3),t.R50("ngModel",n.autre.period),t.R7$(3),t.R50("ngModel",n.autre.year),t.R7$(3),t.R50("ngModel",n.autre.amountDue)}}function V(r,c){if(1&r){const n=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.nI1(11,"number"),t.k0s(),t.j41(12,"td")(13,"select",40),t.mxI("ngModelChange",function(e){const a=t.eBV(n).$implicit;return t.DH7(a.status,e)||(a.status=e),t.Njj(e)}),t.bIt("change",function(){const e=t.eBV(n).$implicit,a=t.XpG();return t.Njj(a.update(e.id,{status:e.status}))}),t.j41(14,"option",41),t.EFF(15,"Brouillon"),t.k0s(),t.j41(16,"option",42),t.EFF(17,"Valid\xe9"),t.k0s(),t.j41(18,"option",43),t.EFF(19,"Pay\xe9"),t.k0s()()(),t.j41(20,"td")(21,"button",44),t.bIt("click",function(){const e=t.eBV(n).$implicit,a=t.XpG();return t.Njj(a.remove(e.id))}),t.EFF(22,"Supprimer"),t.k0s()()()}if(2&r){const n=c.$implicit;t.R7$(2),t.JRh(n.category),t.R7$(2),t.JRh(n.type),t.R7$(2),t.JRh(n.period),t.R7$(2),t.JRh(n.year),t.R7$(2),t.JRh(t.i5U(11,6,n.amountDue,"1.2-2")),t.R7$(3),t.R50("ngModel",n.status)}}let B=(()=>{class r{constructor(n,i,e){var a=this;this.ds=n,this.js=i,this.es=e,this.cat="FISCAL",this.active="TVA",this.filterType="",this.filterCat="",this.tva={period:"",year:(new Date).getFullYear(),caHt:0,tvaCollecte:0,achatHt:0,tvaDeductible:0,journal:"OD",acctCollecte:"445",acctDeductible:"345",contrepartie:"512"},this.is={year:(new Date).getFullYear(),resultat:0,taux:25,journal:"OD",acct:"444",contrepartie:"512"},this.iuts={period:"",year:(new Date).getFullYear(),base:0,taux:1,journal:"OD",acct:"442",contrepartie:"512"},this.bic={period:"",year:(new Date).getFullYear(),base:0,taux:25,journal:"OD",acct:"444",contrepartie:"512"},this.cnss={period:"",year:(new Date).getFullYear(),masse:0,tauxEmp:16,tauxSal:5,journal:"SAL",acctChargeEmp:"645",acctRetenueSal:"421",acctCnss:"43"},this.autre={type:"",period:"",year:(new Date).getFullYear(),amountDue:0},this.records=[],this.selectedCountryCode="",this.selectedCountryName="",this.selectedCurrency="",this.taxInfo=null,this.taxesDataset=[],this.ds.getAll().subscribe(o=>this.records=o),this.es.getSettings().subscribe(o=>{const s=(o?.app?.country||"").trim();s&&(this.selectedCountryCode=s.toUpperCase(),this.tryApplyTaxDefaults())}),this.es.getIdentity().subscribe(o=>{if(!this.selectedCountryCode){const s=(o?.country||"").trim();s&&2===s.length&&(this.selectedCountryCode=s.toUpperCase(),this.tryApplyTaxDefaults())}}),(0,g.A)(function*(){try{let o=yield fetch("assets/data/taxes-by-country-json.json").then(s=>s.ok?s.json():null);(!o||!Array.isArray(o.countriesTaxes))&&(o=yield fetch("assets/data/countries-taxes.json").then(s=>s.ok?s.json():null)),o&&Array.isArray(o.countriesTaxes)&&(a.taxesDataset=o.countriesTaxes,a.tryApplyTaxDefaults())}catch{}})()}tryApplyTaxDefaults(){if(!this.selectedCountryCode||!this.taxesDataset?.length)return;const n=this.taxesDataset.find(i=>String(i.code).toUpperCase()===this.selectedCountryCode);n&&(this.selectedCountryName=n.name||"",this.selectedCurrency=n.currency||"",this.taxInfo=n.taxes||null,null!=this.taxInfo?.corporateIncomeTax?.rate&&(this.is.taux=Number(this.taxInfo.corporateIncomeTax.rate),this.bic.taux=Number(this.taxInfo.corporateIncomeTax.rate)),null!=this.taxInfo?.socialContributions?.employer?.rate&&(this.cnss.tauxEmp=Number(this.taxInfo.socialContributions.employer.rate)),null!=this.taxInfo?.socialContributions?.employee?.rate&&(this.cnss.tauxSal=Number(this.taxInfo.socialContributions.employee.rate)))}tvaDue(){return Math.max(0,(Number(this.tva.tvaCollecte)||0)-(Number(this.tva.tvaDeductible)||0))}isDue(){return Math.max(0,(Number(this.is.resultat)||0)*((Number(this.is.taux)||0)/100))}iutsDue(){return Math.max(0,(Number(this.iuts.base)||0)*((Number(this.iuts.taux)||0)/100))}bicDue(){return Math.max(0,(Number(this.bic.base)||0)*((Number(this.bic.taux)||0)/100))}cnssEmpDue(){return Math.max(0,(Number(this.cnss.masse)||0)*((Number(this.cnss.tauxEmp)||0)/100))}cnssSalDue(){return Math.max(0,(Number(this.cnss.masse)||0)*((Number(this.cnss.tauxSal)||0)/100))}save(n,i,e,a){this.ds.add({type:n,period:e.period||`${e.year}`,year:Number(e.year)||0,amountDue:i,status:"BROUILLON",data:e,category:a||void 0})}update(n,i){this.ds.update(n,i)}remove(n){confirm("Supprimer ?")&&this.ds.remove(n)}exportCsv(){const n=this.ds.exportCsv(this.filterType||void 0,this.filterCat||void 0),i=URL.createObjectURL(n),e=document.createElement("a");e.href=i,e.download="declarations.csv",e.click(),URL.revokeObjectURL(i)}onImport(n){const i=n.target,e=i.files?.[0];if(!e)return;const a=new FileReader;a.onload=()=>{const o=String(a.result||"");this.ds.importCsv(o),i.value=""},a.readAsText(e,"utf-8")}addSimpleEntry(n,i,e,a,o){const s=[{compte:e,libelle:i,debit:o,credit:0},{compte:a,libelle:i,debit:0,credit:o}],p=(new Date).toISOString().slice(0,10);this.js.addEcriture({date:p,journalCode:n||"OD",piece:"DECL",reference:i,lignes:s})}genEcritureTVA(){const n=this.tvaDue();n<=0||this.addSimpleEntry(this.tva.journal,`TVA p\xe9riode ${this.tva.period||this.tva.year}`,this.tva.contrepartie,this.tva.acctCollecte,n)}genEcritureIS(){const n=this.isDue();n<=0||this.addSimpleEntry(this.is.journal,`IS ${this.is.year}`,this.is.contrepartie,this.is.acct,n)}genEcritureIUTS(){const n=this.iutsDue();n<=0||this.addSimpleEntry(this.iuts.journal,`IUTS ${this.iuts.period||this.iuts.year}`,this.iuts.contrepartie,this.iuts.acct,n)}genEcritureBIC(){const n=this.bicDue();n<=0||this.addSimpleEntry(this.bic.journal,`BIC ${this.bic.period||this.bic.year}`,this.bic.contrepartie,this.bic.acct,n)}genEcritureCNSS(){const n=this.cnssEmpDue(),i=this.cnssSalDue(),e=n+i;if(e<=0)return;const a=`CNSS ${this.cnss.period||this.cnss.year}`,o=[];n>0&&o.push({compte:this.cnss.acctChargeEmp,libelle:a+" part employeur",debit:n,credit:0}),i>0&&o.push({compte:this.cnss.acctRetenueSal,libelle:a+" part salari\xe9",debit:i,credit:0}),o.push({compte:this.cnss.acctCnss,libelle:a,debit:0,credit:e});const s=(new Date).toISOString().slice(0,10);this.js.addEcriture({date:s,journalCode:this.cnss.journal||"SAL",piece:"DECL",reference:a,lignes:o})}static{this.\u0275fac=function(i){return new(i||r)(t.rXU(b),t.rXU(T.p),t.rXU(f.T))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-tax-declarations"]],standalone:!0,features:[t.aNF],decls:60,vars:16,consts:[[1,"module-container"],["class","help",4,"ngIf"],[1,"tabs"],[1,"tab",3,"click"],[4,"ngIf"],[1,"toolbar"],[1,"input",3,"ngModelChange","ngModel"],["value",""],["value","TVA"],["value","IS"],["value","CNSS"],["value","AUTRE"],["value","FISCAL"],["value","SOCIAL"],["value","AUTRES"],[1,"btn",3,"click"],["type","file","accept",".csv",3,"change"],[1,"table"],[4,"ngFor","ngForOf"],[1,"help"],[1,"subtabs"],["class","panel",4,"ngIf"],[1,"panel"],[1,"grid"],["placeholder","2025-07",1,"input",3,"ngModelChange","ngModel"],["type","number",1,"input",3,"ngModelChange","ngModel"],["type","number","step","0.01",1,"input",3,"ngModelChange","ngModel"],["placeholder","VEN/ACH/BNK",1,"input",3,"ngModelChange","ngModel"],["placeholder","445",1,"input",3,"ngModelChange","ngModel"],["placeholder","345",1,"input",3,"ngModelChange","ngModel"],[1,"row"],["placeholder","OD/BNK",1,"input",3,"ngModelChange","ngModel"],["placeholder","444",1,"input",3,"ngModelChange","ngModel"],["placeholder","442",1,"input",3,"ngModelChange","ngModel"],["placeholder","SAL/BNK",1,"input",3,"ngModelChange","ngModel"],["placeholder","645",1,"input",3,"ngModelChange","ngModel"],["placeholder","421",1,"input",3,"ngModelChange","ngModel"],["placeholder","43",1,"input",3,"ngModelChange","ngModel"],["placeholder","Ex: IUTS, BIC, etc.",1,"input",3,"ngModelChange","ngModel"],["placeholder","2025-07 ou 2025-T1",1,"input",3,"ngModelChange","ngModel"],[1,"input",3,"ngModelChange","change","ngModel"],["value","BROUILLON"],["value","VALIDE"],["value","PAYE"],[1,"btn","danger",3,"click"]],template:function(i,e){1&i&&(t.j41(0,"div",0)(1,"h1"),t.EFF(2,"\u{1f4cb} D\xe9clarations"),t.k0s(),t.DNE(3,E,7,3,"div",1),t.j41(4,"div",2)(5,"button",3),t.bIt("click",function(){return e.cat="FISCAL"}),t.EFF(6,"Fiscales"),t.k0s(),t.j41(7,"button",3),t.bIt("click",function(){return e.cat="SOCIAL"}),t.EFF(8,"Sociales"),t.k0s(),t.j41(9,"button",3),t.bIt("click",function(){return e.cat="AUTRES"}),t.EFF(10,"Autres"),t.k0s()(),t.DNE(11,k,14,12,"div",4)(12,N,47,18,"div",4)(13,A,20,4,"div",4),t.j41(14,"h3"),t.EFF(15,"Historique des d\xe9clarations"),t.k0s(),t.j41(16,"div",5)(17,"select",6),t.mxI("ngModelChange",function(o){return t.DH7(e.filterType,o)||(e.filterType=o),o}),t.j41(18,"option",7),t.EFF(19,"Toutes"),t.k0s(),t.j41(20,"option",8),t.EFF(21,"TVA"),t.k0s(),t.j41(22,"option",9),t.EFF(23,"IS"),t.k0s(),t.j41(24,"option",10),t.EFF(25,"CNSS"),t.k0s(),t.j41(26,"option",11),t.EFF(27,"Autres"),t.k0s()(),t.j41(28,"select",6),t.mxI("ngModelChange",function(o){return t.DH7(e.filterCat,o)||(e.filterCat=o),o}),t.j41(29,"option",7),t.EFF(30,"Toutes cat\xe9gories"),t.k0s(),t.j41(31,"option",12),t.EFF(32,"Fiscales"),t.k0s(),t.j41(33,"option",13),t.EFF(34,"Sociales"),t.k0s(),t.j41(35,"option",14),t.EFF(36,"Autres"),t.k0s()(),t.j41(37,"button",15),t.bIt("click",function(){return e.exportCsv()}),t.EFF(38,"Export CSV"),t.k0s(),t.j41(39,"input",16),t.bIt("change",function(o){return e.onImport(o)}),t.k0s()(),t.j41(40,"table",17)(41,"thead")(42,"tr")(43,"th"),t.EFF(44,"Cat\xe9gorie"),t.k0s(),t.j41(45,"th"),t.EFF(46,"Type"),t.k0s(),t.j41(47,"th"),t.EFF(48,"P\xe9riode"),t.k0s(),t.j41(49,"th"),t.EFF(50,"Ann\xe9e"),t.k0s(),t.j41(51,"th"),t.EFF(52,"Montant d\xfb"),t.k0s(),t.j41(53,"th"),t.EFF(54,"Statut"),t.k0s(),t.j41(55,"th"),t.EFF(56,"Actions"),t.k0s()()(),t.j41(57,"tbody"),t.DNE(58,V,23,9,"tr",18),t.nI1(59,"typeFilter"),t.k0s()()()),2&i&&(t.R7$(3),t.Y8G("ngIf",e.selectedCountryCode&&e.selectedCountryName),t.R7$(2),t.AVh("active","FISCAL"===e.cat),t.R7$(2),t.AVh("active","SOCIAL"===e.cat),t.R7$(2),t.AVh("active","AUTRES"===e.cat),t.R7$(2),t.Y8G("ngIf","FISCAL"===e.cat),t.R7$(),t.Y8G("ngIf","SOCIAL"===e.cat),t.R7$(),t.Y8G("ngIf","AUTRES"===e.cat),t.R7$(4),t.R50("ngModel",e.filterType),t.R7$(11),t.R50("ngModel",e.filterCat),t.R7$(30),t.Y8G("ngForOf",t.i5U(59,13,e.records,e.filterType)))},dependencies:[d.MD,d.Sq,d.bT,d.QX,u.YN,u.xH,u.y7,u.me,u.Q0,u.wz,u.BC,u.vS,j],styles:[".module-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;box-shadow:0 4px 16px #00000014}.tabs[_ngcontent-%COMP%]{display:flex;gap:6px;margin-bottom:8px}.subtabs[_ngcontent-%COMP%]{display:flex;gap:6px;margin:8px 0}.tab[_ngcontent-%COMP%]{padding:8px 12px;border:none;border-radius:6px;background:#e2e8f0;cursor:pointer}.tab.active[_ngcontent-%COMP%]{background:#3182ce;color:#fff}.panel[_ngcontent-%COMP%]{border:1px solid #e2e8f0;border-radius:8px;padding:12px;margin-bottom:12px}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,minmax(180px,1fr));gap:8px}.toolbar[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center;margin:8px 0}.help[_ngcontent-%COMP%]{margin:6px 0;color:#4a5568}.input[_ngcontent-%COMP%]{padding:8px 10px;border:1px solid #e2e8f0;border-radius:6px}.btn[_ngcontent-%COMP%]{padding:8px 10px;border:none;border-radius:6px;background:#3182ce;color:#fff;cursor:pointer}.btn.danger[_ngcontent-%COMP%]{background:#e53e3e}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #e2e8f0;padding:8px 10px;text-align:left}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f7fafc}"]})}}return r})()},5312:(x,_,l)=>{l.d(_,{c:()=>g});const g={production:!1,name:"development",amplify:{region:"us-west-2",apiUrl:"https://dev-api.e-compta-ia.com",cognitoDomain:"dev-auth.e-compta-ia.com"},apiUrl:"https://e-compta-ia-backend.dev",app:{name:"E-COMPTA-IA",version:"1.0.0",description:"Plateforme Comptable SYSCOHADA avec IA"}}}}]);